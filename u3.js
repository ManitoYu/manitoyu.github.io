!function(t){function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}var e={};i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},i.p="/",i(i.s=15)}([function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(5),r=e(6),n=Math.acos,o=function(){function t(t,i,e){this.x=0,this.y=0,this.z=0,this.x=t,this.y=i,this.z=e}return t.prototype.set=function(t,i,e){return this.x=t,this.y=i,this.z=e,this},Object.defineProperty(t.prototype,"magnitude",{get:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"normalized",{get:function(){return new t(this.x,this.y,this.z).normalize()},enumerable:!0,configurable:!0}),t.lerp=function(t,i,e){return i.subtract(t).multiply(e).add(t)},t.prototype.angle=function(t){var i=this.magnitude*t.magnitude;return 0==i?0:n(r.clamp(this.dot(t)/i,-1,1))/Math.PI*180},t.prototype.equal=function(t){return r.equalf(this.x,t.x)&&r.equalf(this.y,t.y)&&r.equalf(this.z,t.z)},t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y,this.z+i.z)},t.prototype.subtract=function(i){return new t(this.x-i.x,this.y-i.y,this.z-i.z)},t.prototype.multiply=function(i){return new t(this.x*i,this.y*i,this.z*i)},t.prototype.divide=function(i){s.default(0!=i,"Vector3 divide n must not be 0");var e=1/i;return new t(this.x*e,this.y*e,this.z*e)},t.prototype.addSelf=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},t.prototype.subtractSelf=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},t.prototype.multiplySelf=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.prototype.divideSelf=function(t){s.default(0!=t,"Vector3 divide n must not be 0");var i=1/t;return this.x*=i,this.y*=i,this.z*=i,this},t.prototype.oppsite=function(){return this.multiply(-1)},t.prototype.normalize=function(){var t=this.magnitude;if(0==t)return this;var i=1/t;return this.x*=i,this.y*=i,this.z*=i,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.cross=function(i){return new t(this.y*i.z-this.z*i.y,this.z*i.x-this.x*i.z,this.x*i.y-this.y*i.x)},t.prototype.distance=function(t){var i=this.x-t.x,e=this.y-t.y,s=this.z-t.z;return Math.sqrt(Math.pow(i,2)+Math.pow(e,2)+Math.pow(s,2))},t.prototype.scale=function(i){return new t(this.x*i.x,this.y*i.y,this.z*i.z)},t.prototype.zero=function(){return this.x=0,this.y=0,this.z=0,this},t.back=new t(0,0,-1),t.down=new t(0,-1,0),t.forward=new t(0,0,1),t.left=new t(-1,0,0),t.one=new t(1,1,1),t.right=new t(1,0,0),t.up=new t(0,1,0),t.zero=new t(0,0,0),t}();i.default=o},function(t,i,e){"use strict";var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=e(4),n=e(0),o=e(3),h=e(10),m=e(2),a=e(5),u=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.aspect=0,i.farClipPlane=0,i.nearClipPlane=0,i.pixelWidth=0,i.pixelHeight=0,i.fieldOfView=60,i}return s(i,t),i.prototype.render=function(){var t=new n.default(0,0,-1).normalize(),i=new n.default(0,1,0),e=t.cross(i);this.worldToCameraMatrix=new h.default(e.x,e.y,e.z,0,i.x,i.y,i.z,0,t.x,t.y,t.z,0,0,0,0,1).multiplyMatrix(h.default.fromQuaternion(this.transform.rotation)).multiplyMatrix(h.default.TRS(this.transform.position.multiply(-1),m.default.identity,n.default.one)),this.projectionMatrix=h.default.perspective(this.fieldOfView,this.aspect,this.nearClipPlane,this.farClipPlane),this.worldToViewportMatrix=this.projectionMatrix.multiplyMatrix(this.worldToCameraMatrix),this.viewportToScreenMatrix=new h.default(this.pixelWidth/2,0,0,this.transform.position.x,0,this.pixelHeight/2,0,this.transform.position.y,0,0,1,.5,0,0,0,1),this.screenToViewportMatrix=this.viewportToScreenMatrix.inverse(),this.viewportToWorldMatrix=this.worldToViewportMatrix.inverse()},i.prototype.screenToViewPoint=function(t){return this.screenToViewportMatrix.multiplyPoint(new n.default(t.x-this.pixelWidth/2,t.y-this.pixelHeight/2,t.z))},i.prototype.screenToWorldPoint=function(t){return this.viewportToWorldPoint(this.screenToViewPoint(t))},i.prototype.viewportToWorldPoint=function(t){var i=this.viewportToWorldMatrix.multiplyVector4(new o.default(t.x*t.z,t.y*t.z,-this.projectionMatrix.m33*t.z+this.projectionMatrix.m34,t.z));return new n.default(i.x,i.y,i.z)},i.prototype.worldToClipSpaceCoordinate=function(t){return this.worldToViewportMatrix.multiplyVector4(new o.default(t.x,t.y,t.z,1))},i.prototype.clipSpaceToWorldPoint=function(t){var i=this.viewportToWorldMatrix.multiplyVector4(t);return new n.default(i.x,i.y,i.z)},i.prototype.worldToViewportPoint=function(t){var i=this.worldToClipSpaceCoordinate(t);return new n.default(i.x/i.w,i.y/i.w,i.z)},i.prototype.viewportToScreenPoint=function(t){var i=this.viewportToScreenMatrix.multiplyPoint(t);return i.set(Math.round(this.pixelWidth/2+i.x),Math.round(this.pixelHeight/2+i.y),i.z)},i.prototype.worldToScreenPoint=function(t){return a.default(void 0!==this.worldToCameraMatrix,"worldToCameraMatrix is undefined"),this.viewportToScreenPoint(this.worldToViewportPoint(t))},i.main=new i,i}(r.default);i.default=u},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(0),r=Math.cos,n=Math.sin,o=Math.abs,h=Math.atan2,m=Math.PI,a=Math.asin,u=function(){function t(t,i,e,s){this.x=t,this.y=i,this.z=e,this.w=s}return Object.defineProperty(t.prototype,"eulerAngles",{get:function(){var t=-2*(this.y*this.z-this.w*this.x);return o(t)>.9999?new s.default(1.570796*t/m*180,h(-this.x*this.z-this.w*this.y,.5-Math.pow(this.y,2)-Math.pow(this.z,2))/m*180,0):new s.default(a(t)/m*180,h(this.x*this.z+this.w*this.y,.5-Math.pow(this.x,2)-Math.pow(this.y,2))/m*180,h(this.x*this.y+this.w*this.z,.5-Math.pow(this.x,2)-Math.pow(this.z,2))/m*180)},enumerable:!0,configurable:!0}),t.prototype.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.cross=function(i){return new t(this.w*i.x+this.x*i.w+this.y*i.z-this.z*i.y,this.w*i.y+this.y*i.w+this.z*i.x-this.x*i.z,this.w*i.z+this.z*i.w+this.x*i.y-this.y*i.x,this.w*i.w-this.x*i.x-this.y*i.y-this.z*i.z)},t.prototype.inverse=function(){return new t(-this.x,-this.y,-this.z,this.w)},t.euler=function(i,e,s){var o=i/2/180*m,h=e/2/180*m,a=s/2/180*m;return new t(r(h)*n(o)*r(a)+n(h)*r(o)*n(a),n(h)*r(o)*r(a)-r(h)*n(o)*n(a),r(h)*r(o)*n(a)-n(h)*n(o)*r(a),r(h)*r(o)*r(a)+n(h)*n(o)*n(a))},t.identity=new t(0,0,0,1),t}();i.default=u},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(6),r=function(){function t(t,i,e,s){this.x=t,this.y=i,this.z=e,this.w=s}return t.prototype.set=function(t,i,e,s){return this.x=t,this.y=i,this.z=e,this.w=s,this},t.prototype.equal=function(t){return s.equalf(this.x,t.x)&&s.equalf(this.y,t.y)&&s.equalf(this.z,t.z)&&s.equalf(this.w,t.w)},t.lerp=function(t,i,e){return i.subtract(t).multiply(e).add(t)},t.prototype.subtract=function(i){return new t(this.x-i.x,this.y-i.y,this.z-i.z,this.w-i.w)},t.prototype.multiply=function(i){return new t(this.x*i,this.y*i,this.z*i,this.w*i)},t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y,this.z+i.z,this.w+i.w)},t}();i.default=r},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(8),r=e(17),n=e(18),o=function(){function t(){this.transform=new s.default,this.meshFilter=new r.default,this.meshRenderer=new n.default}return t.prototype.submit=function(){return[]},t}();i.default=o},function(t,i,e){"use strict";function s(t,i){if(!t)throw new Error(i)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=s},function(t,i,e){"use strict";function s(t,i){return o(t-i)<=.01}function r(t,i,e){return t<i?i:t>e?e:t}function n(t,i,e){return t+(i-t)*e}Object.defineProperty(i,"__esModule",{value:!0});var o=Math.abs;i.equalf=s,i.clamp=r,i.lerp=n},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.set=function(t,i){return this.x=t,this.y=i,this},t.lerp=function(t,i,e){return i.subtract(t).multiply(e).add(t)},t.prototype.subtract=function(i){return new t(this.x-i.x,this.y-i.y)},t.prototype.multiply=function(i){return new t(this.x*i,this.y*i)},t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y)},t}();i.default=s},function(t,i,e){"use strict";var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=e(0),n=e(2),o=e(9),h=e(10),m=Math.cos,a=Math.sin,u=Math.PI,l=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.position=r.default.zero,i.rotation=n.default.identity,i.scale=r.default.one,i}return s(i,t),i.prototype.rotate=function(t){this.rotation=this.rotation.cross(n.default.euler(t.x,t.y,t.z))},i.prototype.rotateAround=function(t,i,e){var s=i.normalized,r=m(e/180*u),o=a(e/180*u);this.position=new h.default(Math.pow(s.x,2)*(1-r)+r,s.x*s.y*(1-r)+s.z*o,s.x*s.z*(1-r)+s.y*o,0,s.x*s.y*(1-r)+s.z*o,Math.pow(s.y,2)*(1-r)+r,s.y*s.z*(1-r)-s.x*o,0,s.x*s.z*(1-r)-s.y*o,s.y*s.z*(1-r)+s.x*o,Math.pow(s.z,2)*(1-r)+r,0,0,0,0,1).multiplyPoint(this.position.subtract(t)).add(t),this.rotation=this.rotation.cross(n.default.euler(s.x*e,s.y*e,s.z*e))},i.prototype.translate=function(t){this.position=h.default.TRS(t,n.default.identity,r.default.one).multiplyPoint(this.position)},Object.defineProperty(i.prototype,"localToWorldMatrix",{get:function(){return h.default.TRS(this.position,this.rotation,this.scale)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"worldToLocalMatrix",{get:function(){return this.localToWorldMatrix.inverse()},enumerable:!0,configurable:!0}),i}(o.default);i.default=l},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(){}return t}();i.default=s},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(0),r=e(3),n=e(5),o=Math.tan,h=Math.PI,m=function(){function t(t,i,e,s,r,n,o,h,m,a,u,l,f,c,d,p){this.m11=t,this.m12=i,this.m13=e,this.m14=s,this.m21=r,this.m22=n,this.m23=o,this.m24=h,this.m31=m,this.m32=a,this.m33=u,this.m34=l,this.m41=f,this.m42=c,this.m43=d,this.m44=p}return Object.defineProperty(t.prototype,"transpose",{get:function(){return new t(this.m11,this.m21,this.m31,this.m41,this.m12,this.m22,this.m32,this.m42,this.m13,this.m23,this.m33,this.m43,this.m14,this.m24,this.m34,this.m44)},enumerable:!0,configurable:!0}),t.prototype.multiplyNumber=function(i){return new t(this.m11*i,this.m12*i,this.m13*i,this.m14*i,this.m21*i,this.m22*i,this.m23*i,this.m24*i,this.m31*i,this.m32*i,this.m33*i,this.m34*i,this.m41*i,this.m42*i,this.m43*i,this.m44*i)},t.prototype.multiplyMatrix=function(i){return new t(this.m11*i.m11+this.m12*i.m21+this.m13*i.m31+this.m14*i.m41,this.m11*i.m12+this.m12*i.m22+this.m13*i.m32+this.m14*i.m42,this.m11*i.m13+this.m12*i.m23+this.m13*i.m33+this.m14*i.m43,this.m11*i.m14+this.m12*i.m24+this.m13*i.m34+this.m14*i.m44,this.m21*i.m11+this.m22*i.m21+this.m23*i.m31+this.m24*i.m41,this.m21*i.m12+this.m22*i.m22+this.m23*i.m32+this.m24*i.m42,this.m21*i.m13+this.m22*i.m23+this.m23*i.m33+this.m24*i.m43,this.m21*i.m14+this.m22*i.m24+this.m23*i.m34+this.m24*i.m44,this.m31*i.m11+this.m32*i.m21+this.m33*i.m31+this.m34*i.m41,this.m31*i.m12+this.m32*i.m22+this.m33*i.m32+this.m34*i.m42,this.m31*i.m13+this.m32*i.m23+this.m33*i.m33+this.m34*i.m43,this.m31*i.m14+this.m32*i.m24+this.m33*i.m34+this.m34*i.m44,this.m41*i.m11+this.m42*i.m21+this.m43*i.m31+this.m44*i.m41,this.m41*i.m12+this.m42*i.m22+this.m43*i.m32+this.m44*i.m42,this.m41*i.m13+this.m42*i.m23+this.m43*i.m33+this.m44*i.m43,this.m41*i.m14+this.m42*i.m24+this.m43*i.m34+this.m44*i.m44)},t.prototype.multiplyVector4=function(t){return new r.default(t.x*this.m11+t.y*this.m12+t.z*this.m13+t.w*this.m14,t.x*this.m21+t.y*this.m22+t.z*this.m23+t.w*this.m24,t.x*this.m31+t.y*this.m32+t.z*this.m33+t.w*this.m34,t.x*this.m41+t.y*this.m42+t.z*this.m43+t.w*this.m44)},t.prototype.multiplyPoint=function(t){var i=this.multiplyVector4(new r.default(t.x,t.y,t.z,1));return new s.default(i.x,i.y,i.z)},t.TRS=function(i,e,s){var r=t.fromQuaternion(e);return new t(r.m11*s.x,r.m21,r.m31,i.x,r.m12,r.m22*s.y,r.m32,i.y,r.m13,r.m23,r.m33*s.z,i.z,0,0,0,1)},t.fromQuaternion=function(i){return new t(1-2*Math.pow(i.y,2)-2*Math.pow(i.z,2),2*i.x*i.y+2*i.w*i.z,2*i.x*i.z-2*i.w*i.y,0,2*i.x*i.y-2*i.w*i.z,1-2*Math.pow(i.x,2)-2*Math.pow(i.z,2),2*i.y*i.z+2*i.w*i.x,0,2*i.x*i.z+2*i.w*i.y,2*i.y*i.z-2*i.w*i.x,1-2*Math.pow(i.x,2)-2*Math.pow(i.y,2),0,0,0,0,1)},t.perspective=function(i,e,s,r){var n=1/o(i/2/180*h);return new t(n/e,0,0,0,0,n,0,0,0,0,(s+r)/(s-r),2*s*r/(s-r),0,0,-1,0)},t.prototype.inverse=function(){var i=this.m11*(+this.m22*this.m33*this.m44+this.m23*this.m34*this.m42+this.m24*this.m32*this.m43-this.m24*this.m33*this.m42-this.m23*this.m32*this.m44-this.m22*this.m34*this.m43)+this.m12*(+this.m21*this.m33*this.m44+this.m23*this.m34*this.m41+this.m24*this.m31*this.m43-this.m24*this.m33*this.m41-this.m23*this.m31*this.m44-this.m21*this.m34*this.m43)+this.m13*(+this.m21*this.m32*this.m44+this.m22*this.m34*this.m41+this.m24*this.m31*this.m42-this.m24*this.m32*this.m41-this.m22*this.m31*this.m44-this.m21*this.m34*this.m42)+this.m14*(+this.m21*this.m32*this.m43+this.m22*this.m33*this.m41+this.m23*this.m31*this.m42-this.m23*this.m32*this.m41-this.m22*this.m31*this.m43-this.m21*this.m33*this.m42);return n.default(0!=i,"the matrix can not be inversed"),new t(+this.m22*this.m33*this.m44+this.m23*this.m34*this.m42+this.m24*this.m32*this.m43-this.m24*this.m33*this.m42-this.m23*this.m32*this.m44-this.m22*this.m34*this.m43,-1*(+this.m21*this.m33*this.m44+this.m23*this.m34*this.m41+this.m24*this.m31*this.m43-this.m24*this.m33*this.m41-this.m23*this.m31*this.m44-this.m21*this.m34*this.m43),+this.m21*this.m32*this.m44+this.m22*this.m34*this.m41+this.m24*this.m31*this.m42-this.m24*this.m32*this.m41-this.m22*this.m31*this.m44-this.m21*this.m34*this.m42,-1*(+this.m21*this.m32*this.m43+this.m22*this.m33*this.m41+this.m23*this.m31*this.m42-this.m23*this.m32*this.m41-this.m22*this.m31*this.m43-this.m21*this.m33*this.m42),-1*(+this.m12*this.m33*this.m44+this.m13*this.m34*this.m42+this.m14*this.m32*this.m43-this.m14*this.m33*this.m42-this.m13*this.m32*this.m44-this.m12*this.m34*this.m43),+this.m11*this.m33*this.m44+this.m13*this.m34*this.m41+this.m14*this.m31*this.m43-this.m14*this.m33*this.m41-this.m13*this.m31*this.m44-this.m11*this.m34*this.m43,-1*(+this.m11*this.m32*this.m44+this.m12*this.m34*this.m41+this.m14*this.m31*this.m42-this.m14*this.m32*this.m41-this.m12*this.m21*this.m34-this.m11*this.m34*this.m42),+this.m11*this.m32*this.m43+this.m12*this.m33*this.m41+this.m13*this.m31*this.m42-this.m13*this.m32*this.m41-this.m12*this.m31*this.m43-this.m11*this.m33*this.m42,+this.m12*this.m23*this.m44+this.m13*this.m24*this.m42+this.m14*this.m22*this.m43-this.m14*this.m23*this.m42-this.m13*this.m22*this.m44-this.m12*this.m24*this.m43,-1*(+this.m11*this.m23*this.m44+this.m13*this.m24*this.m41+this.m14*this.m21*this.m43-this.m14*this.m23*this.m41-this.m13*this.m21*this.m44-this.m11*this.m24*this.m43),+this.m11*this.m22*this.m44+this.m12*this.m24*this.m41*this.m14*this.m21*this.m42-this.m14*this.m22*this.m41-this.m12*this.m21*this.m44-this.m11*this.m24*this.m42,-1*(+this.m11*this.m22*this.m43+this.m12*this.m23*this.m41+this.m13*this.m21*this.m42-this.m13*this.m22*this.m41-this.m12*this.m21*this.m43-this.m11*this.m23*this.m42),-1*(+this.m12*this.m23*this.m34+this.m13*this.m24*this.m32+this.m14*this.m22*this.m33-this.m14*this.m23*this.m32-this.m13*this.m22*this.m34-this.m12*this.m24*this.m33),+this.m11*this.m23*this.m34+this.m13*this.m24*this.m31+this.m14*this.m21*this.m33-this.m14*this.m23*this.m31-this.m13*this.m21*this.m34-this.m11*this.m24*this.m33,-1*(+this.m11*this.m22*this.m34+this.m12*this.m24*this.m31+this.m14*this.m21*this.m32-this.m14*this.m22*this.m31-this.m12*this.m21*this.m34-this.m11*this.m24*this.m32),+this.m11*this.m22*this.m33+this.m12*this.m23*this.m31+this.m13*this.m21*this.m32-this.m13*this.m22*this.m31-this.m12*this.m21*this.m33-this.m11*this.m23*this.m32).transpose.multiplyNumber(1/i)},t.identity=new t(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),t.zero=new t(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),t}();i.default=m},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(8),r=e(12),n=e(0),o=function(){function t(){this.transform=new s.default,this.intensity=1,this.color=new r.default(1,1,1,1)}return Object.defineProperty(t.prototype,"lightDirection",{get:function(){return this.transform.localToWorldMatrix.multiplyPoint(n.default.zero).normalize()},enumerable:!0,configurable:!0}),t.main=new t,t}();i.default=o},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,i,e,s){this.r=t,this.g=i,this.b=e,this.a=s}return t.prototype.set=function(t,i,e,s){return this.r=t,this.g=i,this.b=e,this.a=s,this},t}();i.default=s},function(t,i,e){"use strict";var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=e(7),n=e(0),o=function(){function t(){}return t}();i.Mesh=o;var h=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.vertices=[new n.default(-.5,.5,-.5),new n.default(-.5,-.5,-.5),new n.default(.5,.5,-.5),new n.default(.5,-.5,-.5),new n.default(.5,.5,-.5),new n.default(.5,-.5,-.5),new n.default(.5,.5,.5),new n.default(.5,-.5,.5),new n.default(.5,.5,.5),new n.default(.5,-.5,.5),new n.default(-.5,.5,.5),new n.default(-.5,-.5,.5),new n.default(-.5,.5,.5),new n.default(-.5,-.5,.5),new n.default(-.5,.5,-.5),new n.default(-.5,-.5,-.5),new n.default(-.5,.5,.5),new n.default(-.5,.5,-.5),new n.default(.5,.5,.5),new n.default(.5,.5,-.5),new n.default(-.5,-.5,-.5),new n.default(-.5,-.5,.5),new n.default(.5,-.5,-.5),new n.default(.5,-.5,.5)],i.uv=[new r.default(0,1),new r.default(0,0),new r.default(1,1),new r.default(1,0),new r.default(0,1),new r.default(0,0),new r.default(1,1),new r.default(1,0),new r.default(0,1),new r.default(0,0),new r.default(1,1),new r.default(1,0),new r.default(0,1),new r.default(0,0),new r.default(1,1),new r.default(1,0),new r.default(0,1),new r.default(0,0),new r.default(1,1),new r.default(1,0),new r.default(0,1),new r.default(0,0),new r.default(1,1),new r.default(1,0)],i.uv2=[new r.default(0,0),new r.default(0,.5),new r.default(.33333333,0),new r.default(.33333333,.5),new r.default(.33333333,0),new r.default(.33333333,.5),new r.default(.66666666,0),new r.default(.66666666,.5),new r.default(.66666666,0),new r.default(.66666666,.5),new r.default(1,0),new r.default(1,.5),new r.default(0,.5),new r.default(0,1),new r.default(.33333333,.5),new r.default(.33333333,1),new r.default(.33333333,.5),new r.default(.33333333,1),new r.default(.66666666,.5),new r.default(.66666666,1),new r.default(.66666666,.5),new r.default(.66666666,1),new r.default(1,.5),new r.default(1,1)],i.triangles=[2,1,0,1,2,3,6,5,4,5,6,7,10,9,8,9,10,11,14,13,12,13,14,15,18,17,16,17,18,19,22,21,20,21,22,23],i}return s(i,t),i}(o);i.CubeMesh=h;var m=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.vertices=[new n.default(-.5,.5,0),new n.default(-.5,-.5,0),new n.default(.5,.5,0),new n.default(.5,-.5,0)],i.uv=[new r.default(0,1),new r.default(0,0),new r.default(1,1),new r.default(1,0)],i.triangles=[2,1,0,1,2,3],i}return s(i,t),i}(o);i.QuadMesh=m},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(0),r=e(12),n=e(1),o=e(11),h=Math.max,m=void 0,a=document.createElement("canvas"),u=a.getContext("2d"),l=new Image;l.src="/magic.png",l.onload=function(){a.width=l.naturalWidth,a.height=l.naturalHeight,u.drawImage(l,0,0,l.naturalWidth,l.naturalHeight),m=u.getImageData(0,0,l.naturalWidth,l.naturalHeight).data};var f=new r.default(0,0,0,0),c=o.default.main.lightDirection,d=c.add(n.default.main.transform.localToWorldMatrix.multiplyPoint(new s.default(0,0,-1))).normalize(),p=new s.default(.1,.1,.1),y=function(){function t(){}return t.prototype.vertexProgram=function(t){return{position:this.uniform.MVPMatrix.multiplyVector4(t.position),mvPosition:this.uniform.MVMatrix.multiplyVector4(t.position),texcoord:t.texcoord,normal:t.normal}},t.prototype.surfaceProgram=function(t){var i=h(0,t.normal.dot(c)),e=h(0,t.normal.dot(d));e=0==i?0:Math.pow(e,.5);var r=4*(Math.round(t.texcoord.y*(l.naturalHeight-1))*l.naturalWidth+Math.round(t.texcoord.x*(l.naturalWidth-1))),n=new s.default(m[r]/255,m[r+1]/255,m[r+2]/255).scale(p.add(s.default.one.multiply(i*o.default.main.intensity))).add(s.default.one.multiply(.2*e));return f.set(n.x,n.y,n.z,m[r+3]/255)},t.main=new t,t}();i.default=y},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),e(16),e(19)},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(1),r=e(2),n=e(0),o=e(11);s.default.main.fieldOfView=60,s.default.main.pixelWidth=800,s.default.main.pixelHeight=600,s.default.main.aspect=s.default.main.pixelWidth/s.default.main.pixelHeight,s.default.main.nearClipPlane=.3,s.default.main.farClipPlane=1e3,s.default.main.transform.rotation=r.default.euler(30,0,0),s.default.main.transform.position=new n.default(0,4,-8),s.default.main.render(),o.default.main.transform.position=new n.default(0,1,-1),o.default.main.intensity=1},function(t,i,e){"use strict";var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=e(9),n=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return s(i,t),i}(r.default);i.default=n},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(){}return t}();i.default=s},function(t,i,e){"use strict";function s(t,i){return t.reduce(function(t,e){return t.concat(i(e))},[])}function r(){M.forEach(function(t){1!=t.transform.position.y&&-1!=t.transform.position.y||t.transform.rotateAround(h.default.zero,h.default.up,90*l.default.deltaTime),0==t.transform.position.y&&t.transform.rotateAround(h.default.zero,h.default.down,90*l.default.deltaTime)}),v.render(z)}function n(){l.default.realTimeSinceStartup+=l.default.deltaTime,requestAnimationFrame(r),o(),_=setTimeout(n,30)}function o(){clearTimeout(_)}Object.defineProperty(i,"__esModule",{value:!0});var h=e(0),m=e(2),a=e(20),u=e(21),l=e(22),f=e(23),c=e(27),d=document.createElement("canvas");d.width=800,d.height=600,d.style.display="block",document.body.insertBefore(d,document.body.children[0]);var p=document.createElement("button");p.textContent="start",p.addEventListener("click",n),document.body.insertBefore(p,d);var y=document.createElement("button");y.textContent="stop",y.addEventListener("click",o),document.body.insertBefore(y,d);var w=document.createElement("input");w.type="range",w.value="0",w.addEventListener("change",function(t){M[0].transform.rotation=m.default.euler(0,-t.target.value/100*90,0),r()}),document.body.insertBefore(w,d);var x=d.getContext("2d"),v=new f.default(x),z=new c.default,b=[-1,0,1],M=s(b,function(t){return s(b,function(i){return s(b,function(e){var s=new a.default;return s.transform.translate(new h.default(t,i,e)),[s]})})});M.forEach(function(t){return z.addGameObject(t)});var _=(new u.default,null)},function(t,i,e){"use strict";var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=e(4),n=e(13),o=function(t){function i(){var i=t.call(this)||this;return i.meshFilter.gameObject=i,i.meshFilter.mesh=new n.CubeMesh,i.meshRenderer.gameObject=i,i}return s(i,t),i.prototype.submit=function(){for(var t=[],i=this.transform.localToWorldMatrix,e=0;e<this.meshFilter.mesh.triangles.length;e+=3){var s=i.multiplyPoint(this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e]]),r=i.multiplyPoint(this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e+1]]),n=i.multiplyPoint(this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e+2]]),o=r.subtract(s).cross(n.subtract(r)).normalize();t.push({a:{position:this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e]],normal:o,texcoord:this.meshFilter.mesh.uv2[this.meshFilter.mesh.triangles[e]]},b:{position:this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e+1]],normal:o,texcoord:this.meshFilter.mesh.uv2[this.meshFilter.mesh.triangles[e+1]]},c:{position:this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e+2]],normal:o,texcoord:this.meshFilter.mesh.uv2[this.meshFilter.mesh.triangles[e+2]]}})}return t},i}(r.default);i.default=o},function(t,i,e){"use strict";var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=e(4),n=e(13),o=function(t){function i(){var i=t.call(this)||this;return i.meshFilter.gameObject=i,i.meshFilter.mesh=new n.QuadMesh,i.meshRenderer.gameObject=i,i}return s(i,t),i.prototype.submit=function(){for(var t=[],i=this.transform.localToWorldMatrix,e=0;e<this.meshFilter.mesh.triangles.length;e+=3){var s=i.multiplyPoint(this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e]]),r=i.multiplyPoint(this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e+1]]),n=i.multiplyPoint(this.meshFilter.mesh.vertices[this.meshFilter.mesh.triangles[e+2]]),o=r.subtract(s).cross(n.subtract(r)).normalize();t.push({a:{position:s,normal:o,texcoord:this.meshFilter.mesh.uv[this.meshFilter.mesh.triangles[e]]},b:{position:r,normal:o,texcoord:this.meshFilter.mesh.uv[this.meshFilter.mesh.triangles[e+1]]},c:{position:n,normal:o,texcoord:this.meshFilter.mesh.uv[this.meshFilter.mesh.triangles[e+2]]}})}return t},i}(r.default);i.default=o},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(){}return t.deltaTime=.03,t}();i.default=s},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(24),r=e(25),n=e(26),o=e(1),h=e(14),m=e(3),a=function(){function t(t){this.rasterizer=new s.default,this.clipper=new r.default,this.imageContext=t;var i=this.imageContext.canvas.width,e=this.imageContext.canvas.height;this.zBuffer=new Array(2*i*e*2),this.frame=this.imageContext.createImageData(i,e),this.frameBuffer=this.frame.data,this.msaaColorBuffer=this.imageContext.createImageData(2*i,2*e).data,this.rasterizer.zBuffer=this.zBuffer,this.rasterizer.frameBuffer=this.frameBuffer,this.rasterizer.msaaColorBuffer=this.msaaColorBuffer}return t.prototype.submit=function(t){var i=this,e=t.submit(),s=t.transform.localToWorldMatrix;h.default.main.uniform={MVMatrix:o.default.main.worldToCameraMatrix.multiplyMatrix(s),MVPMatrix:o.default.main.worldToViewportMatrix.multiplyMatrix(s)},n.flatMap(e,function(t){return i.clipper.clip([h.default.main.vertexProgram({position:new m.default(t.a.position.x,t.a.position.y,t.a.position.z,1),texcoord:t.a.texcoord,normal:t.a.normal}),h.default.main.vertexProgram({position:new m.default(t.b.position.x,t.b.position.y,t.b.position.z,1),texcoord:t.b.texcoord,normal:t.b.normal}),h.default.main.vertexProgram({position:new m.default(t.c.position.x,t.c.position.y,t.c.position.z,1),texcoord:t.c.texcoord,normal:t.c.normal})])}).forEach(function(t){return i.rasterizer.lerp(t)})},t.prototype.render=function(t){var i=this;this.rasterizer.zBuffer.fill(o.default.main.farClipPlane),this.rasterizer.frameBuffer.fill(0),t.gameObjects.forEach(function(t){return i.submit(t)}),this.imageContext.putImageData(this.frame,0,0)},t}();i.default=a},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(0),r=e(7),n=e(6),o=e(1),h=e(14),m=Math.abs,a=Math.round,u=function(){function t(){}return t.prototype.lerp=function(t){var i=t.map(function(t){return{screenPoint:o.default.main.viewportToScreenPoint(new s.default(t.position.x/t.position.w,t.position.y/t.position.w,t.position.w)),vertex:t}}),e=i.slice().sort(function(t,i){return t.screenPoint.y<=i.screenPoint.y?-1:1}),u=e[0].screenPoint,l=e[1].screenPoint,f=e[2].screenPoint,c=e[0].vertex.texcoord,d=e[1].vertex.texcoord,p=e[2].vertex.texcoord,y=(l.y-u.y)/(l.x-u.x),w=(f.y-l.y)/(f.x-l.x),x=(f.y-u.y)/(f.x-u.x);if(!(i[0].screenPoint.subtract(i[1].screenPoint).cross(i[2].screenPoint.subtract(i[1].screenPoint)).normalize().z<0))for(var v,z,b,M,_,g,P,O,j,T,F=l.subtract(u).cross(f.subtract(l)).normalize(),C=0,V=0,W=u.y;W<f.y;W++){W<l.y?(V=u.x+(m(y)==1/0?0:1/y)*(W-u.y),b=1/n.lerp(1/u.z,1/l.z,(W-u.y)/(l.y-u.y)),v=r.default.lerp(c.multiply(1/u.z),d.multiply(1/l.z),(W-u.y)/(l.y-u.y)).multiply(b)):(V=l.x+(m(w)==1/0?0:1/w)*(W-l.y),b=1/n.lerp(1/l.z,1/f.z,(W-l.y)/(f.y-l.y)),v=r.default.lerp(d.multiply(1/l.z),p.multiply(1/f.z),(W-l.y)/(f.y-l.y)).multiply(b)),C=u.x+(m(x)==1/0?0:1/x)*(W-u.y),M=1/n.lerp(1/u.z,1/f.z,(W-u.y)/(f.y-u.y)),z=r.default.lerp(c.multiply(1/u.z),p.multiply(1/f.z),(W-u.y)/(f.y-u.y)).multiply(M),j=a(C),T=a(V),j>T&&(j=T+j,T=j-T,j-=T);for(var B=j;B<=T;B++)if(P=F.z<0?(B-j)/(T-j):1-(B-j)/(T-j),O=1/n.lerp(1/b,1/M,P),this.zBuffer[4*(W*o.default.main.pixelWidth+B)]>O){this.zBuffer[4*(W*o.default.main.pixelWidth+B)]=O,_=r.default.lerp(v.multiply(1/b),z.multiply(1/M),P).multiply(O),_.x=n.clamp(_.x,0,1),_.y=n.clamp(_.y,0,1),g=h.default.main.surfaceProgram({normal:i[0].vertex.normal,texcoord:_});var S=4*(a(599*(1-W/600))*o.default.main.pixelWidth+a(B/800*799));this.frameBuffer[S]=255*g.r,this.frameBuffer[S+1]=255*g.g,this.frameBuffer[S+2]=255*g.b,this.frameBuffer[S+3]=255*g.a}}},t}();i.default=u},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(7),r=e(3),n=function(){function t(){}return t.prototype.clip=function(t){var i=this,e=function(t,s){if(64==s)return t;for(var r=[],n=0;n<t.length;n++)r=r.concat(i.getVertexsByEndpoints(t[n],t[n].position,t[(n+1)%t.length],t[(n+1)%t.length].position,s));return e(r,s<<1)},s=e(t,1);return this.getTrianglesByVertexs(s)},t.prototype.getTrianglesByVertexs=function(t){for(var i=[],e=0;e<t.length-2;e++)i.push([t[0],t[e+1],t[e+2]]);return i},t.prototype.getVertexsByEndpoints=function(t,i,e,n,o){var h=this.getAreaCode(i),m=this.getAreaCode(n);if(0==(h&o|m&o))return[e];if((h&o&m&o)==o)return[];var a=void 0;(h&o|m&o)==o&&(1==o&&(a=(i.x+i.w)/(i.w-n.w+i.x-n.x)),2==o&&(a=(i.x-i.w)/(n.w-i.w+i.x-n.x)),4==o&&(a=(i.y+i.w)/(i.w-n.w+i.y-n.y)),8==o&&(a=(i.y-i.w)/(n.w-i.w+i.y-n.y)),16==o&&(a=(i.z+i.w)/(i.w-n.w+i.z-n.z)),32==o&&(a=(i.z-i.w)/(n.w-i.w+i.z-n.z)));var u=r.default.lerp(i,n,a),l={color:t.color,position:u,normal:t.normal,texcoord:s.default.lerp(t.texcoord,e.texcoord,a)};return 0==(h&o)?[l]:0==(m&o)?[l,e]:void 0},t.prototype.getAreaCode=function(t){var i=0;return t.w+t.x<0&&(i|=1),t.w-t.x<0&&(i|=2),t.w+t.y<0&&(i|=4),t.w-t.y<0&&(i|=8),t.w+t.z<0&&(i|=16),t.w-t.z<0&&(i|=32),i},t}();i.default=n},function(t,i,e){"use strict";function s(t,i){return t.reduce(function(t,e){return t.concat(i(e))},[])}Object.defineProperty(i,"__esModule",{value:!0}),i.flatMap=s},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(){this.gameObjects=[]}return t.prototype.addGameObject=function(t){this.gameObjects.push(t)},t}();i.default=s}]);